* ML
** mnist_cnn
使用mnist作为数据集的CNN神经网络实现

*** 运行
训练
#+begin_src shell
  cd mnist_cnn ; cargo run --release -- train
#+end_src

推理
#+begin_src shell
  cd mnist_cnn; cargo run --release -- infer --image_path ./images --model_path ./model.safetensors
#+end_src

*** 架构
采用两层卷积 两层池化层 两层全连接层 一层softmax 损失函数使用cross_entropy

反向传播优化器使用AdamW

其中 卷积层的卷积核均为3*3 最大池化层均为2*2 激活函数是relu

全连接层第一层输出为128分类 第二层为10分类

模型架构
#+begin_src rust
pub struct MnistCnn{
    conv1:  Conv2d,
    conv2:  Conv2d,
    fc1: Linear,
    fc2: Linear,
}
#+end_src

正向传播架构
#+begin_src rust
  xs
      .apply(&self.conv1)?
      .relu()?
      .max_pool2d(2)?
      .apply(&self.conv2)?
      .relu()?
      .max_pool2d(2)?
      .flatten_from(1)?
      .apply(&self.fc1)?
      .relu()?
      .apply(&self.fc2)?
#+end_src
